spring:
  application:
    name: artists-api-test
  
  # Database H2 in-memory (opção 1 - mais rápida)
  datasource:
    url: jdbc:h2:mem:testdb;MODE=PostgreSQL;DATABASE_TO_LOWER=TRUE;DEFAULT_NULL_ORDERING=HIGH
    username: sa
    password: 
    driver-class-name: org.h2.Driver
    hikari:
      initialization-fail-timeout: 10000
  
  # JPA Configuration
  jpa:
    hibernate:
      ddl-auto: create-drop  # Recria o banco a cada teste
    show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.H2Dialect
        format_sql: true
  
  # Flyway - DESABILITADO para testes (H2 cria schema automaticamente)
  flyway:
    enabled: false
  
  # H2 Console (opcional - útil para debug)
  h2:
    console:
      enabled: true
      path: /h2-console

server:
  port: 0  # Porta aleatória para evitar conflitos

management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: always

app:
  name: Artists API Test
  version: 1.0.0-TEST
  description: API para testes automatizados

# MinIO - Mock/Desabilitado para testes
minio:
  endpoint: http://localhost:9000
  external-endpoint: http://localhost:9000
  access-key: test
  secret-key: test
  bucket-name: test-bucket
  presigned-url-expiration: 300

# JWT - Configuração de teste
jwt:
  secret: test-secret-key-for-testing-purposes-only-do-not-use-in-production
  expiration: 3600000        # 1 hora para testes
  refresh-expiration: 7200000 # 2 horas

# CORS - Liberado para testes
cors:
  allowed-origins: "*"

# Rate Limiting - Desabilitado ou muito permissivo
rate-limit:
  requests: 1000
  duration: 60

# API Regional - Mock/Timeout curto
regional-api:
  connect-timeout: 5000
  read-timeout: 10000
  max-retries: 1
  url: http://localhost:8888/mock  # URL mock

# Sincronização - DESABILITADA
regional-sync:
  enabled: false
  cron: "0 0 0 1 1 ?" # Nunca executa

# Logging - Mais verboso para debug
logging:
  level:
    root: WARN
    com.project.artists: DEBUG
    org.springframework.test: DEBUG
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
  pattern:
    console: "%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"

# Swagger - Desabilitado em testes
springdoc:
  api-docs:
    enabled: false
  swagger-ui:
    enabled: false